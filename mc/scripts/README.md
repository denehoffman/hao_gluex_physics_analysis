### created by:  
*Hao Li (Carnegie Mellon University, 08-Jan-2020)*
-----
 # Environment
 Need halld_sim (>=4.26), hdgeant4, halld_recon

 # Installation
 No need to compile anything. Just set up environment variable (for example in csh):
```sh
$ cd ~hao_gluex_physics_analysis/mc/scripts
$ setenv MC_LOCALDIR $PWD
```
 # Usage: 
```sh
$ ./job_submission.sh 
```
# Features
 The program takes MC_GEN's def file as general input, while sample size and number of samples can be set up directly in the job_submission file. The output files include the ascii file generated by mc_gen, dana_rest file from hd_root and skims from reaction filters.
 
# Simulation Procedure
The run_job_cluster.csh will run through all simulation steps automatically.
| Input | Software | Output | CONFIG |
| ------ | ------ | ------ | ------ |   
|             | mc_gen | input.ascii | input.def (might need flux file) |
| input.ascii | GEN2HDDM_new | input.hddm | - |
| input.hddm  | hdgeant4     | hdgeant.hddm | run.mac, control.in |
| hdgeant.hddm | mcsmear | hdgeant_smeared.hddm | - (random triggers can be added) |
| hdgeant_smeared.hddm | hd_root | dana_rest.hddm | - |
| dana_rest.hddm | hd_root | reaction_name.root, hd_root.root | reaction.config |

# Config
1. flux file can be obtained with this tool (https://github.com/JeffersonLab/hd_utilities/tree/master/psflux).
2. def need set certain keywords as placeholder; then copy it into $MC_LOCALDIR/def
3. reaction.config contains reaction hypotheses used in the kinematic fitter. Do remember to set up a name for each reaction, otherwise the output skim trees won't get copied back properly. It should be saved into $MC_LOCALDIR/config

# To-Do List

- timer for steps
- crash exit and re-submission (often happens during hdgeant)